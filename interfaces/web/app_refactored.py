# interfaces/web/app.py
"""
Maveretta Bot - Dashboard Principal com 13 Abas Integradas
Interface Streamlit unificada com pain√©is Grafana embedados NATIVOS
Todas as 13 abas conforme mapeamento AUDITORIA_MAPEAMENTO_STREAMLIT_GRAFANA
LEGACY: Removido todos os st.metric, consultas Prometheus diretas, gr√°ficos locais
"""
importar sistema operacional
importar sistema
importar urllib.parse
registro de importa√ß√£o
de pathlib importar Caminho

# Configurar registro
logging.basicConfig(n√≠vel=logging.INFO)
registrador = logging.getLogger(__nome__)

# -------------------------
# IMPORTA√á√ïES DE TERCEIROS
# -------------------------
importar streamlit como st
importar streamlit.components.v1 como componentes

# -------------------------
# CONFIGURA√á√ÉO DA P√ÅGINA
# -------------------------
st.set_page_config(
    page_title="Maveretta Bot - Orquestra√ß√£o de Negocia√ß√£o de IA",
    √≠cone_de_p√°gina="ü§ñ",
    layout="amplo",
    initial_sidebar_state="expandido"
)

# -------------------------
# CONSTANTES
# -------------------------
GRAFANA_BASE_URL = os.getenv("GRAFANA_BASE_URL", "http://localhost/grafana").rstrip("/")
APP_DIR = Caminho(__arquivo__).pai

# -------------------------
# AUXILIAR: INCORPORANDO PAINEL GRAFANA
# -------------------------
def grafana_panel(uid: str, slug: str, panel_id: int, altura: int = 300,
                  time_from: str = "agora-6h", time_to: str = "agora"):
    """
    Renderiza painel nativo do Grafana via iframe /d-solo
    
    Argumentos:
        uid: UID do dashboard (extra√≠do do JSON real)
        slug: Slug do t√≠tulo do dashboard (kebab-case)
        panel_id: ID do painel dentro do dashboard
        altura: Altura em pixels (KPI: 260, s√©rie temporal: 400, tabela: 500)
        time_from: Intervalo temporal inicial (padr√£o: agora-6h)
        time_to: Intervalo temporal final (padr√£o: agora)
    """
    par√¢metros = {
        "orgId": "1",
        "panelId": str(id_do_painel),
        "tema": "escuro",
        "quiosque": "",
        "de": tempo_de,
        "para": tempo_para,
    }
    url = f"{GRAFANA_BASE_URL}/d-solo/{uid}/{urllib.parse.quote(slug)}?{urllib.parse.urlencode(params)}"
    st.components.v1.iframe(url, altura=altura, rolagem=Falso)

# -------------------------
# CSS TEMA ESCURO PREMIUM
# -------------------------
TEMA_CSS = """
<estilo>
:raiz {
  --bg: #0a0d14;
  --painel: #141922;
  --painel2: #1c2531;
  --painel3: #252d3d;
  --texto: #e8eaef;
  --texto-secund√°rio: #b8c2d3;
  --silenciado: #8a95a6;
  --acento: #f5c451;
  --accent-hover: #f7d373;
  --verde: #22c55e;
  --vermelho: #ef4444;
  --azul: #3b82f6;
  --roxo: #8b5cf6;
  --borda: #2a3441;
  --luz de borda: #3d4654;
  --sombra: rgba(0,0,0,0.25);
}

html, corpo, .stApp {
  cor de fundo: var(--bg);
  cor: var(--texto);
  fam√≠lia de fontes: 'Segoe UI', -apple-system, BlinkMacSystemFont, sans-serif;
}

.cabe√ßalho-principal {
  alinhamento de texto: centro;
  margem: 0 0 1,5rem 0;
  preenchimento: 1rem 0;
  plano de fundo: gradiente linear (135 graus, var (--panel2) 0%, var (--panel) 100%);
  raio da borda: 12px;
  borda: 1px var s√≥lido (--border);
  caixa-sombra: 0 4px 20px var(--sombra);
  posi√ß√£o: relativa;
  estouro: oculto;
}

.cabe√ßalho-principal::antes de {
  contente: '';
  posi√ß√£o: absoluta;
  topo: 0;
  esquerda: 0;
  direita: 0;
  altura: 3px;
  plano de fundo: gradiente linear(90deg, var(--accent), var(--green), var(--blue));
}

.t√≠tulo-principal {
  tamanho da fonte: 28px;
  espessura da fonte: 800;
  espa√ßamento entre letras: -0,025em;
  cor: var(--texto);
  margem: 0 0 0,25rem 0;
  sombra de texto: 0 2px 4px rgba(0,0,0,0.3);
  exibi√ß√£o: flex√≠vel;
  alinhar-itens: centro;
  justificar-conte√∫do: centro;
}

.subt√≠tulo principal {
  tamanho da fonte: 13px;
  cor: var(--muted);
  espessura da fonte: 500;
  opacidade: 0,8;
}

.stTabs [data-baseweb="lista-de-guias"] {
  lacuna: 2px;
  preenchimento: 6px;
  fundo: var(--painel);
  raio da borda: 12px;
  borda: 1px var s√≥lido (--border);
  margem inferior: 2rem;
  estouro-x: autom√°tico;
  largura da barra de rolagem: fina;
  scrollbar-color: var(--accent) transparente;
}

.stTabs [data-baseweb="guia"] {
  altura: 48px;
  largura m√≠nima: 85px;
  preenchimento: 10px 12px;
  raio da borda: 10px;
  fundo: transparente;
  cor: var(--muted);
  borda: 1px s√≥lido transparente;
  espessura da fonte: 600;
  tamanho da fonte: 12px;
  transi√ß√£o: todos os 0,2s c√∫bicos-bezier(0,4, 0, 0,2, 1);
  cursor: ponteiro;
  espa√ßo em branco: nowrap;
  posi√ß√£o: relativa;
  estouro: oculto;
}

.stTabs [data-baseweb="tab"]:passe o mouse {
  fundo: var(--panel2);
  cor: var(--text-secondary);
  cor da borda: var(--border-light);
  transformar: translateY(-1px);
}

.stTabs [aria-selected="true"] {
  plano de fundo: gradiente linear (135 graus, var (--panel3) 0%, var (--panel2) 100%);
  cor: var(--texto);
  cor da borda: var(--accent);
  caixa-sombra: 0 2px 8px rgba(245, 196, 81, 0,15);
  posi√ß√£o: relativa;
}

.stTabs [aria-selected="true"]::depois {
  contente: '';
  posi√ß√£o: absoluta;
  fundo: 0;
  esquerda: 50%;
  transformar: translateX(-50%);
  largura: 60%;
  altura: 2px;
  fundo: var(--accent);
  raio da borda: 1px;
}

.cabe√ßalho-da-se√ß√£o {
  tamanho da fonte: 18px;
  espessura da fonte: 700;
  margem: 2rem 0 1rem;
  preenchimento: 0,75rem 1rem;
  fundo: gradiente linear (90 graus, var (--panel2) 0%, transparente 100%);
  borda esquerda: 4px s√≥lido var(--accent);
  raio da borda: 0 8px 8px 0;
  cor: var(--texto);
}

.grafana-incorporar {
  borda: 1px var s√≥lido (--border);
  raio da borda: 8px;
  estouro: oculto;
  cor de fundo: var(--panel2);
  margem inferior: 1rem;
  transi√ß√£o: todos os 0,3s de facilidade;
}

.grafana-embed:passe o mouse {
  cor da borda: var(--border-light);
  caixa-sombra: 0 4px 12px var(--sombra);
}

@media (largura m√°xima: 899px) {
  .stTabs [data-baseweb="lista-de-guias"] {
    estouro-x: rolagem;
    largura da barra de rolagem: fina;
  }
  
  .stTabs [data-baseweb="guia"] {
    largura m√≠nima: 95px;
    tamanho da fonte: 12px;
    preenchimento: 10px 12px;
  }
  
  .t√≠tulo-principal {
    tamanho da fonte: 22px;
  }
  
  .cabe√ßalho-da-se√ß√£o {
    tamanho da fonte: 16px;
  }
}
</estilo>
"""

st.markdown(THEME_CSS, unsafe_allow_html=True)

# -------------------------
# CABE√áALHO
# -------------------------
st.markdown('''
<div class="cabe√ßalho-principal">
    <h1 class="main-title">ü§ñ Maveretta Bot - Orquestra√ß√£o de Negocia√ß√£o de IA</h1>
    <p class="main-subtitle">Dashboard Integrado com Pain√©is Nativos do Grafana</p>
</div>
''', unsafe_allow_html=Verdadeiro)

# -------------------------
# 13 ABAS CONFORME MAPEAMENTO
# -------------------------
guias = st.tabs([
    "üìä Vis√£o Geral",
    "üìà Opera√ß√µes",
    "üé∞ Ca√ßa-n√≠queis",
    "üè¶ Tesouro",
    "üéÆ Controles",
    "üß† Insights da IA",
    "üìã Audit√≥rio",
    "üìù Registros",
    "üö® Alertas",
    "üî¨ Testes Retrospectivos",
    "üéØ Estrat√©gias",
    "üéº Orquestra√ß√£o",
    "üí∞ Carteira"
])


# ========================================
# ABA: üìä Vis√£o geral
# ========================================
com abas[0]:
    st.markdown('<div class="section-header">üìä Vis√£o geral</div>', unsafe_allow_html=True)

    # Taxa de aprova√ß√£o de consenso (ID do painel: 3)
    grafana_panel(uid="agente-drilldown-fase3", slug="agente-drilldown-fase-3", panel_id=3, altura=200)

    # Motivos de bloqueio de risco (ID do painel: 5)
    grafana_panel(uid="agente-drilldown-fase3", slug="agente-drilldown-fase-3", panel_id=5, altura=300)

    # Consenso aprovado (por s√≠mbolo) (ID do painel: 3)
    grafana_panel(uid="agentes-vis√£o-geral-fase-3", slug="agentes-vis√£o-geral-fase-3", panel_id=3, altura=300)

    st.markdown('<div style="margem: 1.5rem 0;"></div>', unsafe_allow_html=True)

    # Total de posi√ß√µes abertas (ID do painel: 6)
    grafana_panel(uid="agentes-vis√£o-geral-fase-3", slug="agentes-vis√£o-geral-fase-3", panel_id=6, altura=200)

    # Rodadas de consenso (1h) (ID do painel: 1)
    grafana_panel(uid="maveretta-consensus-flow", slug="maveretta-consensus-flow", panel_id=1, height=300)

    # Consenso aprovado (1h) (ID do painel: 2)
    grafana_panel(uid="maveretta-consensus-flow", slug="maveretta-consensus-flow", panel_id=2, height=300)

    st.markdown('<div style="margem: 1.5rem 0;"></div>', unsafe_allow_html=True)

    # Taxa de aprova√ß√£o (1h) (ID do painel: 3)
    grafana_panel(uid="maveretta-consensus-flow", slug="maveretta-consensus-flow", panel_id=3, height=200)

    # Risco bloqueado por motivo (ID do painel: 7)
    grafana_panel(uid="maveretta-consensus-flow", slug="maveretta-consensus-flow", panel_id=7, height=300)

    # Status da conex√£o Bybit (ID do painel: 2)
    grafana_panel(uid="maveretta-bybit-live", slug="maveretta-bybit-live", panel_id=2, altura=200)

    st.markdown('<div style="margem: 1.5rem 0;"></div>', unsafe_allow_html=True)

    # Status de conex√£o da Coinbase (ID do painel: 2)
    grafana_panel(uid="maveretta-coinbase-live", slug="maveretta-coinbase-live", panel_id=2, altura=200)

    # An√°lise de pre√ßos em tempo real - $symbol (ID do painel: 1)
    grafana_panel(uid="maveretta-dynamic-live", slug="maveretta-dynamic-symbol-analysis", panel_id=1, altura=300)

    # Pre√ßo atual (ID do painel: 2)
    grafana_panel(uid="maveretta-dynamic-live", slug="maveretta-dynamic-symbol-analysis", panel_id=2, height=300)

    st.markdown('<div style="margem: 1.5rem 0;"></div>', unsafe_allow_html=True)

    # Volume 24h (ID do painel: 3)
    grafana_panel(uid="maveretta-dynamic-live", slug="maveretta-dynamic-symbol-analysis", panel_id=3, altura=300)

    # Lat√™ncia (ID do painel: 4)
    grafana_panel(uid="maveretta-dynamic-live", slug="maveretta-dynamic-symbol-analysis", panel_id=4, altura=300)

    # Status da conex√£o (ID do painel: 5)
    grafana_panel(uid="maveretta-dynamic-live", slug="maveretta-dynamic-symbol-analysis", panel_id=5, altura=200)

    st.markdown('<div style="margem: 1.5rem 0;"></div>', unsafe_allow_html=True)

    # Status dos Servi√ßos (ID do Painel: 4)
    grafana_panel(uid="maveretta-infraestrutura", slug="maveretta-infraestrutura-sistema", panel_id=4, altura=200)

    # Tr√°fego de rede (ID do painel: 7)
    grafana_panel(uid="maveretta-infraestrutura", slug="maveretta-infraestrutura-sistema", panel_id=7, altura=300)

    # E/S de disco (ID do painel: 8)
    grafana_panel(uid="maveretta-infraestrutura", slug="maveretta-infraestrutura-sistema", panel_id=8, altura=300)

    st.markdown('<div style="margem: 1.5rem 0;"></div>', unsafe_allow_html=True)

    # Status de conex√£o do KuCoin (ID do painel: 2)
    grafana_panel(uid="maveretta-kucoin-live", slug="maveretta-kucoin-live", panel_id=2, height=260)

    # Vis√£o Geral do Mercado - BTC/USDT (ID do painel: 1)
    grafana_panel(uid="maveretta-market-overview", slug="maveretta-market-overview", panel_id=1, height=400)

    # Volume 24h (ID do painel: 2)
    grafana_panel(uid="maveretta-market-overview", slug="maveretta-market-overview", panel_id=2, height=400)

    st.markdown('<div style="margem: 1.5rem 0;"></div>', unsafe_allow_html=True)

    # Status da conex√£o OKX (ID do painel: 2)
    grafana_panel(uid="maveretta-okx-live", slug="maveretta-okx-live", panel_id=2, altura=260)

    # Gr√°fico de Pre√ßos em Tempo Real (ID do painel: 7)
    grafana_panel(uid="maveretta-overview-live", slug="maveretta-overview-live", panel_id=7, altura=400)

    # Pre√ßo Atual (Top 10) (ID do painel: 12)
    grafana_panel(uid="maveretta-overview-live", slug="maveretta-overview-live", panel_id=12, altura=400)

    st.markdown('<div style="margem: 1.5rem 0;"></div>', unsafe_allow_html=True)

    # Ciclos Completos (ID do painel: 16)
    grafana_panel(uid="maveretta-overview-live", slug="maveretta-overview-live", panel_id=16, altura=400)

    # Mensagens WebSocket (ID do painel: 17)
    grafana_panel(uid="maveretta-overview-live", slug="maveretta-overview-live", panel_id=17, altura=400)

    # ATR M√©dio (ID do painel: 19)
    grafana_panel(uid="maveretta-overview-live", slug="maveretta-overview-live", panel_id=19, altura=400)

    st.markdown('<div style="margem: 1.5rem 0;"></div>', unsafe_allow_html=True)

    # Status Conex√£o (ID do painel: 20)
    grafana_panel(uid="maveretta-overview-live", slug="maveretta-overview-live", panel_id=20, altura=260)

    # Sa√∫de / Tempo de atividade - Todos os servi√ßos (ID do painel: 21)
    grafana_panel(uid="maveretta-overview-live", slug="maveretta-overview-live", panel_id=21, altura=400)

    # Ciclos Completados (1h) (ID do Painel: 2)
    grafana_panel(uid="maveretta-slots-live", slug="maveretta-trading-slots", panel_id=2, altura=400)

    st.markdown('<div style="margem: 1.5rem 0;"></div>', unsafe_allow_html=True)

    # Total de Capital (USDT) (ID do Painel: 3)
    grafana_panel(uid="maveretta-slots-live", slug="maveretta-trading-slots", panel_id=3, altura=260)

    # Status de conex√£o (ID do painel: 4)
    grafana_panel(uid="maveretta-slots-live", slug="maveretta-trading-slots", panel_id=4, altura=260)

    # Taxa de Execu√ß√£o (Ciclos/s) (ID do Painel: 6)
    grafana_panel(uid="maveretta-slots-live", slug="maveretta-trading-slots", panel_id=6, altura=400)

    st.markdown('<div style="margem: 1.5rem 0;"></div>', unsafe_allow_html=True)

    # Top 10 de pre√ßos de criptomoedas (USDT) (ID do painel: 1)
    grafana_panel(uid="maveretta-top10-live", slug="maveretta-top-10-prices", panel_id=1, altura=400)

    # Tabela dos 10 principais pre√ßos (ID do painel: 2)
    grafana_panel(uid="maveretta-top10-live", slug="maveretta-top-10-prices", panel_id=2, altura=500)

    # Taxa de sucesso de arbitragem (ID do painel: 1)
    grafana_panel(uid="pernas-de-arbitragem-de-orquestra√ß√£o", slug="pernas-de-arbitragem-de-orquestra√ß√£o", panel_id=1, altura=260)

    st.markdown('<div style="margem: 1.5rem 0;"></div>', unsafe_allow_html=True)

    # Pernas por status (ID do painel: 2)
    grafana_panel(uid="pernas-de-arbitragem-de-orquestra√ß√£o", slug="pernas-de-arbitragem-de-orquestra√ß√£o", panel_id=2, altura=260)

    # Eventos de Auto-Hedge (ID do Painel: 6)
    grafana_panel(uid="pernas-de-arbitragem-de-orquestra√ß√£o", slug="pernas-de-arbitragem-de-orquestra√ß√£o", panel_id=6, altura=400)

    # Vis√£o geral do status do IA (ID do painel: 1)
    grafana_panel(uid="orquestra√ß√£o-ia-sa√∫de", slug="orquestra√ß√£o-ia-sa√∫de", panel_id=1, altura=260)

    st.markdown('<div style="margem: 1.5rem 0;"></div>', unsafe_allow_html=True)

    # Status da troca (ID do painel: 3)
    grafana_panel(uid="sa√∫de-local-de-orquestra√ß√£o", slug="sa√∫de-local-de-orquestra√ß√£o", panel_id=3, altura=260)

    # Status do limite de taxa (ID do painel: 4)
    grafana_panel(uid="sa√∫de-local-de-orquestra√ß√£o", slug="sa√∫de-local-de-orquestra√ß√£o", panel_id=4, altura=260)

# ========================================
# ABA: üìà Opera√ß√µes
# ========================================
com abas[1]:
    st.markdown('<div class="section-header">üìà Opera√ß√µes</div>', unsafe_allow_html=True)

    # Opera√ß√µes em papel com lucros e perdas n√£o realizados (ID do painel: 5)
    grafana_panel(uid="agentes-vis√£o-geral-fase-3", slug="agentes-vis√£o-geral-fase-3", panel_id=5, altura=400)

    # Uso da CPU (ID do painel: 1)
    grafana_panel(uid="maveretta-infraestrutura", slug="maveretta-infraestrutura-sistema", panel_id=1, altura=400)

    # Uso de mem√≥ria (ID do painel: 2)
    grafana_panel(uid="maveretta-infraestrutura", slug="maveretta-infraestrutura-sistema", panel_id=2, altura=400)

    st.markdown('<div style="margem: 1.5rem 0;"></div>', unsafe_allow_html=True)

    # Uso do disco (ID do painel: 3)
    grafana_panel(uid="maveretta-infraestrutura", slug="maveretta-infraestrutura-sistema", panel_id=3, altura=400)

    # Uso da CPU do cont√™iner (ID do painel: 5)
    grafana_panel(uid="maveretta-infraestrutura", slug="maveretta-infraestrutura-sistema", panel_id=5, altura=400)

    # Uso de mem√≥ria do cont√™iner (ID do painel: 6)
    grafana_panel(uid="maveretta-infraestrutura", slug="maveretta-infraestrutura-sistema", panel_id=6, altura=400)

    st.markdown('<div style="margem: 1.5rem 0;"></div>', unsafe_allow_html=True)

    # Lat√™ncia M√©dia (ID do painel: 18)
    grafana_panel(uid="maveretta-overview-live", slug="maveretta-overview-live", panel_id=18, altura=400)

    # Tempo de execu√ß√£o entre locais (ID do painel: 4)
    grafana_panel(uid="pernas-de-arbitragem-de-orquestra√ß√£o", slug="pernas-de-arbitragem-de-orquestra√ß√£o", panel_id=4, altura=400)

    # Lat√™ncia de troca (ID do painel: 1)
    grafana_panel(uid="sa√∫de-local-de-orquestra√ß√£o", slug="sa√∫de-local-de-orquestra√ß√£o", panel_id=1, altura=400)

    st.markdown('<div style="margem: 1.5rem 0;"></div>', unsafe_allow_html=True)

    # Desvio do rel√≥gio (ID do painel: 2)
    grafana_panel(uid="sa√∫de-local-de-orquestra√ß√£o", slug="sa√∫de-local-de-orquestra√ß√£o", panel_id=2, altura=400)

# ========================================
# ABA: üé∞ Ca√ßa-n√≠queis
# ========================================
com abas[2]:
    st.markdown('<div class="section-header">üé∞ Slots</div>', unsafe_allow_html=True)

    # Slots Ativos (ID do Painel: 15)
    grafana_panel(uid="maveretta-overview-live", slug="maveretta-overview-live", panel_id=15, altura=400)

    # Slots Ativos (ID do Painel: 1)
    grafana_panel(uid="maveretta-slots-live", slug="maveretta-trading-slots", panel_id=1, altura=400)

    # Hist√≥rico de Slots Ativos (ID do painel: 5)
    grafana_panel(uid="maveretta-slots-live", slug="maveretta-trading-slots", panel_id=5, altura=400)

    st.markdown('<div style="margem: 1.5rem 0;"></div>', unsafe_allow_html=True)

    # Linha do tempo dos estados dos slots (ID do painel: 1)
    grafana_panel(uid="linha do tempo dos slots de orquestra√ß√£o", slug="linha do tempo dos slots de orquestra√ß√£o", panel_id=1, altura=400)

    # Distribui√ß√£o de estados de slot (ID do painel: 2)
    grafana_panel(uid="linha do tempo dos slots de orquestra√ß√£o", slug="linha do tempo dos slots de orquestra√ß√£o", panel_id=2, altura=400)

    # Contagem de slots ativos (ID do painel: 3)
    grafana_panel(uid="linha do tempo dos slots de orquestra√ß√£o", slug="linha do tempo dos slots de orquestra√ß√£o", panel_id=3, altura=260)

    st.markdown('<div style="margem: 1.5rem 0;"></div>', unsafe_allow_html=True)

    # Altera√ß√µes no estado do slot (ID do painel: 4)
    grafana_panel(uid="linha do tempo dos slots de orquestra√ß√£o", slug="linha do tempo dos slots de orquestra√ß√£o", panel_id=4, altura=400)

# ========================================
# ABA: üè¶ Tesouro
# ========================================
com abas[3]:
    st.markdown('<div class="section-header">üè¶ Tesouro</div>', unsafe_allow_html=True)

    st.info("üöß Se√ß√£o em desenvolvimento. Pain√©is ser√£o adicionados em breve.")

# ========================================
# ABA: üéÆ Controles
# ========================================
com abas[4]:
    st.markdown('<div class="section-header">üéÆ Controles</div>', unsafe_allow_html=True)

    st.info("üöß Se√ß√£o em desenvolvimento. Pain√©is ser√£o adicionados em breve.")

# ========================================
#ABA: üß† Insights de IA
# ========================================
com abas[5]:
    st.markdown('<div class="section-header">üß† Insights de IA</div>', unsafe_allow_html=True)

    # Mapa de calor de confian√ßa (ID do painel: 2)
    grafana_panel(uid="agente-drilldown-fase3", slug="agente-drilldown-fase-3", panel_id=2, altura=500)

    # Status do agente (Em execu√ß√£o=1, Parado=0) (ID do painel: 1)
    grafana_panel(uid="agentes-vis√£o-geral-fase-3", slug="agentes-vis√£o-geral-fase-3", panel_id=1, altura=260)

    # Decis√µes por hora (por agente) (ID do painel: 2)
    grafana_panel(uid="agentes-vis√£o-geral-fase-3", slug="agentes-vis√£o-geral-fase-3", panel_id=2, altura=400)

    st.markdown('<div style="margem: 1.5rem 0;"></div>', unsafe_allow_html=True)

    # M√©dia de confian√ßa de consenso (ID do painel: 4)
    grafana_panel(uid="agentes-vis√£o-geral-fase-3", slug="agentes-vis√£o-geral-fase-3", panel_id=4, altura=400)

    # Redu√ß√£o do Agente % (ID do Painel: 7)
    grafana_panel(uid="agentes-vis√£o-geral-fase-3", slug="agentes-vis√£o-geral-fase-3", panel_id=7, altura=400)

    # Confian√ßa m√©dia (ID do painel: 4)
    grafana_panel(uid="maveretta-consensus-flow", slug="maveretta-consensus-flow", panel_id=4, height=400)

    st.markdown('<div style="margem: 1.5rem 0;"></div>', unsafe_allow_html=True)

    # Cronograma da Fase de Consenso (propor/desafiar/decidir) (ID do Painel: 5)
    grafana_panel(uid="maveretta-consensus-flow", slug="maveretta-consensus-flow", panel_id=5, height=400)

    # Mapa de calor de confian√ßa por agente (ID do painel: 6)
    grafana_panel(uid="maveretta-consensus-flow", slug="maveretta-consensus-flow", panel_id=6, height=500)

    # Pernas com falha por motivo (ID do painel: 5)
    grafana_panel(uid="pernas-de-arbitragem-de-orquestra√ß√£o", slug="pernas-de-arbitragem-de-orquestra√ß√£o", panel_id=5, altura=400)

    st.markdown('<div style="margem: 1.5rem 0;"></div>', unsafe_allow_html=True)

    # Confian√ßa na decis√£o por estrat√©gia (ID do painel: 1)
    grafana_panel(uid="orquestra√ß√£o-decis√£o-conf", slug="orquestra√ß√£o-decis√£o-conf", panel_id=1, altura=260)

    # Confian√ßa na decis√£o por IA (ID do painel: 2)
    grafana_panel(uid="orquestra√ß√£o-decis√£o-conf", slug="orquestra√ß√£o-decis√£o-conf", panel_id=2, altura=400)

    # Distribui√ß√£o de confian√ßa (ID do painel: 3)
    grafana_panel(uid="orquestra√ß√£o-decis√£o-conf", slug="orquestra√ß√£o-decis√£o-conf", panel_id=3, altura=400)

    st.markdown('<div style="margem: 1.5rem 0;"></div>', unsafe_allow_html=True)

    # Decis√µes de alta confian√ßa (>80%) (ID do painel: 4)
    grafana_panel(uid="orquestra√ß√£o-decis√£o-conf", slug="orquestra√ß√£o-decis√£o-conf", panel_id=4, altura=400)

    # Decis√µes de baixa confian√ßa (<50%) (ID do painel: 5)
    grafana_panel(uid="orquestra√ß√£o-decis√£o-conf", slug="orquestra√ß√£o-decis√£o-conf", panel_id=5, altura=400)

    # Confian√ßa m√©dia por slot (ID do painel: 6)
    grafana_panel(uid="orquestra√ß√£o-decis√£o-conf", slug="orquestra√ß√£o-decis√£o-conf", panel_id=6, altura=260)

    st.markdown('<div style="margem: 1.5rem 0;"></div>', unsafe_allow_html=True)

    # Lat√™ncia IA (ms) (ID do painel: 2)
    grafana_panel(uid="orquestra√ß√£o-ia-sa√∫de", slug="orquestra√ß√£o-ia-sa√∫de", panel_id=2, altura=400)

    # Tempo de atividade IA % (ID do painel: 3)
    grafana_panel(uid="orquestra√ß√£o-ia-sa√∫de", slug="orquestra√ß√£o-ia-sa√∫de", panel_id=3, altura=400)

    # Erros por IA (ID do painel: 4)
    grafana_panel(uid="orquestra√ß√£o-ia-sa√∫de", slug="orquestra√ß√£o-ia-sa√∫de", panel_id=4, altura=400)

    st.markdown('<div style="margem: 1.5rem 0;"></div>', unsafe_allow_html=True)

# ========================================
# ABA: üìã Audit√≥rio
# ========================================
com abas[6]:
    st.markdown('<div class="section-header">üìã Auditoria</div>', unsafe_allow_html=True)

    st.info("üöß Se√ß√£o em desenvolvimento. Pain√©is ser√£o adicionados em breve.")

# ========================================
# ABA: üìù Registros
# ========================================
com abas[7]:
    st.markdown('<div class="section-header">üìù Registros</div>', unsafe_allow_html=True)

    # Erros de conex√£o (ID do painel: 5)
    grafana_panel(uid="sa√∫de-local-de-orquestra√ß√£o", slug="sa√∫de-local-de-orquestra√ß√£o", panel_id=5, altura=400)

# ========================================
# ABA: üö® Alertas
# ========================================
com abas[8]:
    st.markdown('<div class="section-header">üö® Alertas</div>', unsafe_allow_html=True)

    st.info("üöß Se√ß√£o em desenvolvimento. Pain√©is ser√£o adicionados em breve.")

# ========================================
# ABA: üî¨ Backtests
# ========================================
com abas[9]:
    st.markdown('<div class="section-header">üî¨ Backtests</div>', unsafe_allow_html=True)

    # Bybit Equity (USDT) (ID do painel: 1)
    grafana_panel(uid="maveretta-bybit-live", slug="maveretta-bybit-live", panel_id=1, altura=260)

    # Coinbase Equity (USDT) (ID do painel: 1)
    grafana_panel(uid="maveretta-coinbase-live", slug="maveretta-coinbase-live", panel_id=1, altura=260)

    # KuCoin Equity (USDT) (ID do painel: 1)
    grafana_panel(uid="maveretta-kucoin-live", slug="maveretta-kucoin-live", panel_id=1, height=260)

    st.markdown('<div style="margem: 1.5rem 0;"></div>', unsafe_allow_html=True)

    # Patrim√¥nio da KuCoin ao longo do tempo (ID do painel: 3)
    grafana_panel(uid="maveretta-kucoin-live", slug="maveretta-kucoin-live", panel_id=3, height=260)

    # OKX Equity (USDT) (ID do painel: 1)
    grafana_panel(uid="maveretta-okx-live", slug="maveretta-okx-live", panel_id=1, altura=260)

    # Carteira Real (USDT) (ID do painel: 13)
    grafana_panel(uid="maveretta-overview-live", slug="maveretta-overview-live", panel_id=13, altura=400)

    st.markdown('<div style="margem: 1.5rem 0;"></div>', unsafe_allow_html=True)

    # Carteira Real (BRL) (ID do painel: 14)
    grafana_panel(uid="maveretta-overview-live", slug="maveretta-overview-live", panel_id=14, altura=400)

# ========================================
# ABA: üéØ Estrat√©gias
# ========================================
com abas[10]:
    st.markdown('<div class="section-header">üéØ Estrat√©gias</div>', unsafe_allow_html=True)

    st.info("üöß Se√ß√£o em desenvolvimento. Pain√©is ser√£o adicionados em breve.")

# ========================================
# ABA: üéº Orquestra√ß√£o
# ========================================
com abas[11]:
    st.markdown('<div class="section-header">üéº Orquestra√ß√£o</div>', unsafe_allow_html=True)

    # Cronograma de decis√£o (Propor/Desafiar/Decidir) (ID do painel: 1)
    grafana_panel(uid="agente-drilldown-fase3", slug="agente-drilldown-fase-3", panel_id=1, altura=400)

    # Lat√™ncia de decis√£o (p50, p95) (ID do painel: 4)
    grafana_panel(uid="agente-drilldown-fase3", slug="agente-drilldown-fase-3", panel_id=4, altura=400)

    # P&L de arbitragem (ID do painel: 3)
    grafana_panel(uid="orquestra√ß√£o-arbitragem-pernas", slug="orquestra√ß√£o-arbitragem-pernas", panel_id=3, altura=400)

    st.markdown('<div style="margem: 1.5rem 0;"></div>', unsafe_allow_html=True)

# ========================================
# ABA: üí∞ Carteira
# ========================================
com abas[12]:
    st.markdown('<div class="section-header">üí∞ Cart√£o</div>', unsafe_allow_html=True)

    st.info("üöß Se√ß√£o em desenvolvimento. Pain√©is ser√£o adicionados em breve.")